<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[timbroder.com]]></title>
    <link href="https://www.timbroder.com/blog/categories/Code.xml" rel="self"/>
    <link href="https://www.timbroder.com/"/>
    <updated>2018-09-09T12:21:32+00:00</updated>
    <id>https://www.timbroder.com/</id>
            <author>
            <name><![CDATA[Tim Broder]]></name>            <email><![CDATA[timothy.broder@gmail.com]]></email>        </author>
        <generator uri="http://sculpin.io/">Sculpin</generator>
            <entry>
            <title type="html"><![CDATA[Feb 23 was a security day]]></title>
            <link href="https://www.timbroder.com/2017/02/Feb-23-was-a-security-day.html"/>
            <updated>2017-02-24T09:22:00+00:00</updated>
            <id>https://www.timbroder.com/2017/02/Feb-23-was-a-security-day.html</id>
            <content type="html"><![CDATA[<p>Busy day yesterday:</p>

<ul>
<li><a href="https://blog.cloudflare.com/incident-report-on-memory-leak-caused-by-cloudflare-parser-bug/" title="Cloudflare leaked secrets">Cloudflare leaked secrets</a></li>
<li><a href="http://www.theverge.com/2017/2/23/14712118/google-sha1-collision-broken-web-encryption-shattered" title="Google cracked SHA-1">Google cracked SHA-1</a></li>
<li>Dropbox opensourced <a href="https://blogs.dropbox.com/tech/2017/02/meet-securitybot-open-sourcing-automated-security-at-scale/" title="Securitybot: Open Sourcing Automated Security at Scale">Securitybot: Automated Security at Scale</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Adding Smart Speed to any audio file with Audacity]]></title>
            <link href="https://www.timbroder.com/2017/01/Adding-SmartSpeed-to-any-audio-file.html"/>
            <updated>2017-01-15T09:18:00+00:00</updated>
            <id>https://www.timbroder.com/2017/01/Adding-SmartSpeed-to-any-audio-file.html</id>
            <content type="html"><![CDATA[<p>The <a href="https://geo.itunes.apple.com/us/app/overcast-podcast-player/id888422857?at=11laRZ&amp;ct=afp15&amp;ls=1&amp;mt=8" title="Overcast">Overcast</a> podcast app by <a href="https://twitter.com/marcoarment" title="Marco Arment">Marco Arment</a> has a killer feature called Smart Speed and it has ruined all audio listening for me outside of the app. Smart Speed <em>dynamically shortens silences in talk shows</em>; it saves you time, and makes them feel tighter and more produced. I wish I had it everywhere.</p>

<p><a href="http://tekside.net/" title="Tekside">Tekside</a> is a podcast network I'm part of, and while some of our shows are heavily edited, many are not. While doing some audio work for <a href="http://heymamapodcast.com/" title="something else">something else</a>, my <a href="https://twitter.com/bingopajamas" title="wife">wife</a> noticed that <a href="http://www.audacityteam.org/" title="Audacity">Audacity</a> (cross platform) has a crud version of this type of audio processing. Here's how to set it up.</p>

<h2 id="setup">Setup</h2>

<ol>
<li><a href="http://www.audacityteam.org/download/" title="Download Audacity">Download Audacity</a> &amp; install it. But don't run it yet. (If it opened as part of install, close it)</li>
<li>If you are working with audio files already, head to "Making it work". If you are pulling in .mov files from <a href="http://www.ecamm.com/mac/callrecorder/" title="Skype Call Recorder">Skype Call Recorder</a> see step 3</li>
<li>Install FFMPEG: If you are on a Mac, download and install <a href="http://lame3.buanzo.com.ar/FFmpeg_v0.6.2_for_Audacity_on_OSX.dmg" title="this">this</a> Otherwise, see <a href="http://manual.audacityteam.org/man/faq_installation_and_plug_ins.html#ffdown" title="these instructions">these instructions</a></li>
</ol>

<h2 id="making-it-work">Making it work</h2>

<ol>
<li>Open Audacity</li>
<li>Click File -> Import Audio</li>
<li>Choose your audio recording</li>
<li>Optional: If Audacity prompts you to "Select Stream(s) to import", select all of them and hit OK <img src="https://c1.staticflickr.com/6/5567/32174620192_8f027bbbef_b.jpg" alt="" /></li>
<li>Select one of the audio streams and hit CMD+A to highlight all of the audio</li>
<li>Click Effect -> Truncate Silence</li>
<li>I currently have <strong>duration</strong> set to <strong>0.9</strong> and <strong>truncate to</strong> set to <strong>0.5</strong>. What this does is find any silence longer that 0.9 seconds and shorten it to 0.5 seconds <img src="https://c1.staticflickr.com/1/281/32174511182_ee8cfc68db_b.jpg" alt="" /></li>
<li>Hit ok &amp; let it run</li>
<li>File -> Export <em>(As a WAV. You may have to hit OK a few times)</em></li>
<li>Done!</li>
</ol>

<p>I'm still figuring out which duration will work best for which shows. It depends how fast the people on it already naturally talk and flow which each other. For <a href="http://tekside.net/showandtell/" title="Show and Tell">Show and Tell</a>, our movie podcast, the above settings strip a 55 min recording to 48 mins and it sounds a lot tighter.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Using an Encrypted Realm in a background or notification processes?]]></title>
            <link href="https://www.timbroder.com/2016/10/Using-an-Encrypted-Realm-with-background-or-notificatio-processes.html"/>
            <updated>2016-10-30T13:54:00+00:00</updated>
            <id>https://www.timbroder.com/2016/10/Using-an-Encrypted-Realm-with-background-or-notificatio-processes.html</id>
            <content type="html"><![CDATA[<p><em>Note: This post's primary purpose is to help me think through this problem. I have no prescribed solution at the end of it. The conversation will continue on <a href="http://stackoverflow.com/q/40332246/647343" title="Stack Overflow">Stack Overflow</a>. I will update this post once I have a final approach.</em></p>

<p>Realm has a great <a href="https://realm.io/docs/swift/latest/#encryption" title="write up">write up</a> and <a href="https://github.com/realm/realm-cocoa/blob/master/examples/ios/swift-2.2/Encryption/ViewController.swift" title="sample code">sample code</a> for encrypting your database. This documentation and sample work as intended, until you try to decrypt realm when:</p>

<ol>
<li>A user has a password on their phone</li>
<li>The device is locked</li>
<li>Your app is trying to do work with Realm when a remote notification comes in</li>
</ol>

<p>This happens because we can't access the keychain to get (or create) the key to en/decrypt the Realm. The default <code>kSecAttrAccessible</code> value is <code>kSecAttrAccessibleWhenUnlocked</code></p>

<p>There are a few options as I see them:</p>

<ol>
<li>Change <code>kSecAttrAccessible</code> to <code>kSecAttrAccessibleAlways</code>. I don't like this because it's a) too open and b) it was <a href="http://stackoverflow.com/questions/32112678/ksecattraccessiblealways-deprecated-in-ios-9#comment53491023_32600761" title="slated to be deprecated in iOS 9">slated to be deprecated in iOS 9</a></li>
<li>Change <code>kSecAttrAccessible</code> to <code>kSecAttrAccessibleAfterFirstUnlock</code> or <code>kSecAttrAccessibleAfterFirstUnlockThisDeviceOnly</code>. This is better but still feels too open to <em>me</em>, even though the <a href="https://developer.apple.com/reference/security/ksecattraccessibleafterfirstunlockthisdeviceonly" title="docs">docs</a> state: <em>This is recommended for items that need to be accessed by background applications</em></li>
<li>Create a second, non-encrypted Realm to use as a staging database. Store notification data here, then when the app wakes up from user interaction (the device would be unlocked), move the data from the staging Realm into the encrypted real one. This doesn't feel right either, as we'll have data temporarily not encrypted</li>
<li>Combine 2 and 3 and encrypt the staging Realm, and protect it's key with <code>kSecAttrAccessibleAfterFirstUnlockThisDeviceOnly</code></li>
<li>??</li>
</ol>

<p>I'm currently trying to decide if #2, if #3 is worth putting the time into, or if I can come up with a #5</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Using iOS 10 devices with Xcode 7]]></title>
            <link href="https://www.timbroder.com/2016/08/Using-iOS-10-devices-with-Xcode-7.html"/>
            <updated>2016-08-31T16:33:00+00:00</updated>
            <id>https://www.timbroder.com/2016/08/Using-iOS-10-devices-with-Xcode-7.html</id>
            <content type="html"><![CDATA[<p><a href="https://twitter.com/steipete" title="Peter Steinberger">Peter Steinberger</a> started a GREAT <a href="https://gist.github.com/steipete/d9b44d8e9f341e81414e86d7ff8fb62d" title="gist">gist</a> on <em>Using Xcode 7.3.1 and iOS 10 devices</em>.</p>

<p>Below is what worked for me to get a few extra test devices (my carry phone runs the 10 beta) working with Xcode 7. Can't upgrade to 8 just yet. Working with a contractor and don't want to move too many pieces.</p>

<p><strong>My Setup</strong></p>

<p>Xcode 7.3.1 and Beta 6
iOS 10 beta 6 <em>(Beta 7 is out, after getting this to work, I don't think I'm upgrading just yet)</em></p>

<p><strong>Steps</strong></p>

<ol>
<li><code>sudo ln -s /Applications/Xcode-beta.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/10.0\ \(14A5339a\)/ /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport</code></li>
<li>iPhone: Settings > General > Reset > Network Settings</li>
<li>Reboot iPhone <em>(after it wakes back up from the network reset)</em></li>
<li>Reboot Mac <em>(restarting Xcode alone didn't work)</em></li>
</ol>

<p>It these steps don't work for you, check out the <a href="https://gist.github.com/steipete/d9b44d8e9f341e81414e86d7ff8fb62d" title="gist">gist</a> for other options.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Opening iTerm2 Tabs at Specific Directories]]></title>
            <link href="https://www.timbroder.com/2016/07/Opening-iTerm2-Tabs-at-Specific-Directories.html"/>
            <updated>2016-07-21T10:22:00+00:00</updated>
            <id>https://www.timbroder.com/2016/07/Opening-iTerm2-Tabs-at-Specific-Directories.html</id>
            <content type="html"><![CDATA[<p>I love iTerm2. I can customize the stock Terminal.app just about as much, but it's much easier in iTerm. I find myself always opening the same 3 or 4 tabs when I get into coding mode. Luckily iTerm2 has <strong>great</strong> <a href="https://www.iterm2.com/documentation-scripting.html" title="scripting support">scripting support</a></p>

<p>The 4 tabs I always open for <a href="http://www.kidfund.us/" title="Kidfund">Kidfund</a> are:</p>

<ol>
<li>Our iOS project</li>
<li>Our Laravel project. Usually where I run artisan commands</li>
<li>Our Laravel project; Tails most recent file in the log directory</li>
<li>Our Laravel project; I jump around from here. Usually CD-ing to 1. the realm directory to pop it into <a href="https://github.com/realm/realm-browser-osx" title="Realm Browser">Realm Browser</a></li>
</ol>

<p>I didn't want this to run <em>all</em> of the time so I didn't have this script run each time iTerm opens. I instead wired it into an Alfred command. If you are interested you can download that <a href="https://github.com/Kidfund/KidTabs" title="here">here</a></p>

<p>The underlying script is as follows. It's crud, and could definitely be more flexible, but it works for me at the moment. Hopefully it can help you craft something to your needs</p>

<pre><code data-language="applescript">tell application "iTerm2"
  tell current session of current window
    write text "cd ~/workspace/kidfund/ios"
  end tell
  tell current window
    create tab with default profile
      tell current session of current tab
        write text "cd ~/workspace/kidfund/web"
      end tell
  end tell
    tell current window
    create tab with default profile
      tell current session of current tab
        write text "cd ~/workspace/kidfund/web &amp;&amp; tail -f storage/logs/\"$(ls -at storage/logs | head -n 1)\""
      end tell
  end tell
    tell current window
    create tab with default profile
      tell current session of current tab
        write text "cd ~/workspace/kidfund/web"
      end tell
  end tell
end tell
</code></pre>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Github File and Link Tricks]]></title>
            <link href="https://www.timbroder.com/2016/06/Github-File-and-Link-Tricks.html"/>
            <updated>2016-06-09T10:25:00+00:00</updated>
            <id>https://www.timbroder.com/2016/06/Github-File-and-Link-Tricks.html</id>
            <content type="html"><![CDATA[<p>2 tricks I learned today that I'd like to share: reliably linking to a specific line and searching for files using fuzzy matching.</p>

<h1 id="reliably-link-to-a-specific-line">Reliably link to a specific line</h1>

<p>Say you are on the master branch, and you want to reference a line in a file. This could either be for a conversation you are having at that moment, answering a question in a PR, or adding information to a ticket. At that point in time, your link will work great. But, what about when that file gets changed tomorrow? More lines get added higher up, above the link, and the line that the link it pointing to, now points to something else!</p>

<p>You can easily have github switch to the latest commit for the file you are viewing. Just press 'y'. Then, when you link to a line, you are linking to THAT version of the file. You reference will always be intact.</p>

<h1 id="search-for-files-using-fuzzy-matching">Search for files using fuzzy matching</h1>

<p>When you are browsing through files, there is a button in the upper right that says "Find file". I'm sure it's been there forever, but I just noticed it.</p>

<p>This brings you to a full file tree that you can search using fuzzy matching. Just like if you were in your IDE quick-opening a file!</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Open source everything]]></title>
            <link href="https://www.timbroder.com/2016/05/Open-source-everything.html"/>
            <updated>2016-05-24T16:51:00+00:00</updated>
            <id>https://www.timbroder.com/2016/05/Open-source-everything.html</id>
            <content type="html"><![CDATA[<p>Great 2 part series by <a href="https://twitter.com/jesse_squires" title="@jesse_squires">@jesse_squires</a> on the importance of documenting everything and the gains of working in open source. I picked up a few tricks, especially <a href="https://github.com/onevcat/VVDocumenter-Xcode" title="VVDocumenter-Xcode">VVDocumenter-Xcode</a> for docblock generation. But, more importantly is the ethos in which he approaches his work</p>

<ul>
<li><a href="http://www.jessesquires.com/swift-documentation/" title="Swift Documentation">Swift Documentation</a></li>
<li><a href="http://www.jessesquires.com/open-source-everything/" title="Open Source Everything">Open Source Everything</a></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Setup and Teardown the Database Once Per Test Suite in PHPUnit]]></title>
            <link href="https://www.timbroder.com/2016/05/Setup-and-Teardown-the-Database-Once-Per-Test-Suite-with-PHPUnit-Listeners.html"/>
            <updated>2016-05-04T16:15:00+00:00</updated>
            <id>https://www.timbroder.com/2016/05/Setup-and-Teardown-the-Database-Once-Per-Test-Suite-with-PHPUnit-Listeners.html</id>
            <content type="html"><![CDATA[<p>I'm working on a series of integration tests where I want to set up and reset the database for each run. This could easily be done in the setUp and tearDown methods, but doing the full db each time is slow. Yes, I could just do the tables I need, but I was curious, and now I don't have to worry about which tables are setup in my testing DB. In this example, I'm using Laravel's migrations and SQLite as the test DB.</p>

<p><strong>UPDATE 05/05/2016</strong>: As Sebastian <a href="http://www.timbroder.com/2016/05/Setup-and-Teardown-the-Database-Once-Per-Test-Suite-with-PHPUnit-Listeners.html#comment-2659950789" title="point out below">points out below</a> (thanks!) there is a much more appropriate way. Using <code>setUpBeforeClass</code> and <code>tearDownAfterClass</code> we achieve the same effect</p>

<pre><code data-language="php">public static function setUpBeforeClass()
{
    parent::setUpBeforeClass();
    exec('php artisan migrate --database sqlite_test');
}

public static function tearDownAfterClass()
{
    exec('php artisan migrate:reset --database sqlite_test');
    parent::tearDownAfterClass(); 
}
</code></pre>

<p><del>PHPUnit has <a href="https://phpunit.de/manual/current/en/extending-phpunit.html#extending-phpunit.examples.SimpleTestListener.php" title="listeners">listeners</a> that you can tap into at various parts of your tests' lifecycle. I'm particularly interested in when a specific suite starts and ends. We'll need to do 2 things:</del></p>

<ol>
<li><del>Create our Listener</del></li>
<li><del>Register this Listener in phpunit.xml</del></li>
</ol>

<p>The listener is as follows:</p>

<pre><code data-language="php">class FullDBListener extends PHPUnit_Framework_BaseTestListener
{
    protected $suites = ['UserIntegrationTest', 'AccountIntegrationTest'];

    public function startTestSuite(PHPUnit_Framework_TestSuite $suite)
    {
        if (in_array($suite-&gt;getName(), $this-&gt;suites)) {
            exec('php artisan migrate --database sqlite_test');
        }
    }

    public function endTestSuite(PHPUnit_Framework_TestSuite $suite)
    {
        if (in_array($suite-&gt;getName(), $this-&gt;suites)) {
            exec('php artisan migrate:reset --database sqlite_test');
        }
    }
}
</code></pre>

<p>This does a few things:</p>

<ol>
<li><del>Stores the class names of each suite we want to run the db migrations for</del></li>
<li><del>In <code>startTestSuite</code> it checks to see if we're in the right suite</del></li>
<li><del>If we are, run an artisan migration on our test db</del></li>
<li><del>In <code>endTestSuite</code> it checks to see if we're in the right suite</del></li>
<li><del>If we are, run an artisan migration:reset on our test db</del></li>
</ol>

<p><del>Next, we need to make PHPUnit aware of this listener. Update your path accordingly</del></p>

<pre><code data-language="xml">&lt;listeners&gt;
    &lt;listener class="FullDBListener" file="./tests/app/FullDBListener.php"&gt;&lt;/listener&gt;
&lt;/listeners&gt;
</code></pre>

<p>That's it!</p>

<p>I do do some basic teardown in my test suite's <code>setUp</code> method to give me a blank slate. This has proven faster then doing the migrations each time</p>

<pre><code data-language="php">public function setUp()
{
    parent::setUp();

    User::truncate();
}
</code></pre>

<p>I hope this helped you, if you have any questions, let me know!</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Sketch Git Plugin]]></title>
            <link href="https://www.timbroder.com/2016/05/Sketch-Git-Plugin.html"/>
            <updated>2016-05-04T11:10:00+00:00</updated>
            <id>https://www.timbroder.com/2016/05/Sketch-Git-Plugin.html</id>
            <content type="html"><![CDATA[<blockquote>
  <p>A Git client built right into Sketch. Generate pretty diffs so that everybody knows what are the changes!</p>
</blockquote>

<p>Designers can use git too!</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Trying to Mock a Self Booting Laravel Model Trait]]></title>
            <link href="https://www.timbroder.com/2016/04/Trying-to-Mock-a-Self-Booting-Laravel-Model-Trait.html"/>
            <updated>2016-04-12T11:01:00+00:00</updated>
            <id>https://www.timbroder.com/2016/04/Trying-to-Mock-a-Self-Booting-Laravel-Model-Trait.html</id>
            <content type="html"><![CDATA[<p><a href="http://www.archybold.com/blog/post/booting-eloquent-model-traits" title="Bootable">Bootable</a> Model traits are pretty nifty. I'm using them to register certain events for the models using my Trait. However, I've run into an issue trying to mock models that are using the trait. Specifically, when a Mockery version of the model is instantiated, it's boot code agrees that it should have a bootMyTrait method, but can't find it when it tries to call it.</p>

<p><a href="https://github.com/timbroder/mock-bootable-laravel-model-trait" title="Sample Repository">Sample Repository</a> for the below, with commands to reproduce.</p>

<p>As an example, here is a trait:</p>

<pre><code data-language="php">namespace App;
trait MyTrait
{
    public static function bootMyTrait()
    {
        print("Booting MyTrait\n");
    }
}
</code></pre>

<p>And a model using it:</p>

<pre><code data-language="php">namespace App;
use Illuminate\Database\Eloquent\Model;
class MyModel extends Model
{
    use MyTrait;
}
</code></pre>

<p>Instantiating the model regularly works fine. This shows the desired output:</p>

<pre><code data-language="php">$model = new MyModel();
</code></pre>

<p>However, trying to mock this model does not cooperate. This:</p>

<pre><code data-language="php">use Illuminate\Foundation\Testing\WithoutMiddleware;
use Illuminate\Foundation\Testing\DatabaseMigrations;
use Illuminate\Foundation\Testing\DatabaseTransactions;


class ExampleTest extends TestCase
{
    /**
     * A basic functional test example.
     *
     * @return void
     */
    public function testTraitBooting()
    {
        $model = $this-&gt;getMock('App\MyModel');
    }
}
</code></pre>

<p>Fails. Adding some debugging to Eloquent:</p>

<pre><code data-language="php">    /**
     * Boot all of the bootable traits on the model.
     *
     * @return void
     */
    protected static function bootTraits()
    {
        $class = static::class;

        foreach (class_uses_recursive($class) as $trait) {
            print("\nTesting that class: $class has method: " . $method = 'boot'.class_basename($trait) . " because of Trait: $trait\n");
            if (method_exists($class, $method = 'boot'.class_basename($trait))) {
                print("Class: $class has method: $method \n");
                try {
                    forward_static_call([$class, $method]);
                } catch (\PHPUnit_Framework_MockObject_BadMethodCallException $e) {
                    print("Class: $class failed calling $method\n");
                    throw $e;
                }
            }
        }
    }
</code></pre>

<p>Gives us this failure:</p>

<pre><code>PHPUnit 5.1.0 by Sebastian Bergmann and contributors.

E                                                                   1 / 1 (100%)
Testing that class: Mock_MyModel_9ee820db has method: bootMyTrait because of Trait: App\MyTrait
Class: Mock_MyModel_9ee820db has method: bootMyTrait
Class: Mock_MyModel_9ee820db failed calling bootMyTrait


Time: 129 ms, Memory: 18.00Mb

There was 1 error:

1) ExampleTest::testTraitBooting
PHPUnit_Framework_MockObject_BadMethodCallException:

mock-bootable-laravel-model-trait/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:326
mock-bootable-laravel-model-trait/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:309
mock-bootable-laravel-model-trait/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:296
mock-bootable-laravel-model-trait/vendor/laravel/framework/src/Illuminate/Database/Eloquent/Model.php:277
mock-bootable-laravel-model-trait/tests/ExampleTest.php:16
</code></pre>

<p>I've also tried creating the mock a few different ways. Using <a href="https://github.com/laravel/framework/blob/2a38acf7ee2882d831a3b9a1361a710e70ffa31e/tests/Database/DatabaseSoftDeletingTraitTest.php#L14" title="DatabaseSoftDeletingTraitTest">DatabaseSoftDeletingTraitTest</a> as an example:</p>

<pre><code data-language="php">use Illuminate\Foundation\Testing\WithoutMiddleware;
use Illuminate\Foundation\Testing\DatabaseMigrations;
use Illuminate\Foundation\Testing\DatabaseTransactions;
use Mockery as m;

class ExampleTest extends TestCase
{
    /**
     * A basic functional test example.
     *
     * @return void
     */
    public function testTraitBooting()
    {
        $mock = m::mock('App\MyModel');
        $mock-&gt;shouldReceive('bootMyTrait')-&gt;once();
    }
}
</code></pre>

<p>But here, bootMyTrait is never called:</p>

<pre><code>PHPUnit 5.1.0 by Sebastian Bergmann and contributors.

E                                                                   1 / 1 (100%)

Time: 149 ms, Memory: 19.25Mb

There was 1 error:

1) ExampleTest::testTraitBooting
Mockery\Exception\InvalidCountException: Method bootMyTrait() from Mockery_0_App_MyModel should be called
 exactly 1 times but called 0 times.

mock-bootable-laravel-model-trait/vendor/mockery/mockery/library/Mockery/CountValidator/Exact.php:37
mock-bootable-laravel-model-trait/vendor/mockery/mockery/library/Mockery/Expectation.php:271
mock-bootable-laravel-model-trait/vendor/mockery/mockery/library/Mockery/ExpectationDirector.php:120
mock-bootable-laravel-model-trait/vendor/mockery/mockery/library/Mockery/Container.php:297
mock-bootable-laravel-model-trait/vendor/mockery/mockery/library/Mockery/Container.php:282
mock-bootable-laravel-model-trait/vendor/mockery/mockery/library/Mockery.php:142
mock-bootable-laravel-model-trait/vendor/laravel/framework/src/Illuminate/Foundation/Testing/TestCase.php:122
</code></pre>

<p>So, I can move the code I'm doing in the boot method to a ServiceProvider, but then I'll need to register each Model that uses the trait. This feels dirty, and using the boot method seems appropriate. So I think I've either hit a bug, or am Mocking the trait-using-model incorrectly. I've looked at <code>getMockForTrait</code> but I also need the mocked instance to extend Eloquent (a few of the trait's methods call eloquent methods)</p>

<p>If anyone sees something I missed, much appreciated</p>

<p><em>Update Apr, 22 (Friday) 2016-04-22 03:28 PM</em></p>

<p>Thanks to <a href="http://stackoverflow.com/a/36771173/647343" title="Marcin">Marcin</a>, we have a solution!</p>

<pre><code data-language="php">&lt;?php

use Illuminate\Foundation\Testing\WithoutMiddleware;
use Illuminate\Foundation\Testing\DatabaseMigrations;
use Illuminate\Foundation\Testing\DatabaseTransactions;
use Mockery as m;

class ExampleTest extends TestCase
{
    /**
     * A basic functional test example.
     *
     * @return void
     */
    public function testTraitBooting()
    {
        $mock = m::mock('App\MyModel')-&gt;makePartial();
        $mock-&gt;shouldReceive('bootMyTrait')-&gt;once();
        $mock-&gt;__construct();
    }
}

</code></pre>
]]></content>
        </entry>
    </feed>